<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>MCU Dashboard</title>
    <style type="text/css">
        div, h3 {
            clear: left;
        }
    </style>
    
    <link rel="stylesheet" href="static/css/dc.min.css" type="text/css" />
    
    <script type="text/javascript" src="static/js/d3.min.js"></script>
    <script type="text/javascript" src="static/js/crossfilter.min.js"></script>
    <script type="text/javascript" src="static/js/dc.min.js"></script>
    <script type="text/javascript" src="static/js/queue.min.js"></script>
</head>

<body>
    
<div>
  
    <h3>Worldwide Gross per Marvel Franchise!</h3>
    <div id="gross_movie"></div>
    
    <h3> Budget for MCU movies</h3>
    <div id="budgetpertitle"></div>
    
    <h3>Cinemas released in per franchise</h3>
    <div id="cinemas_per_franchise"></div>

</div>

<div>
    <h3>Worldwide Gross per individual Marvel movie!</h3>
    <div id="gross_title"></div>
</div>

<div>
    <div id="scatter"></div>
</div>

<div>
    <h3>Gross over time</h3>
    <div id="gross_scatter_chart"></div>
</div>

<div>
    <h3>Opening Weekend Grosses</h3>
    <div id="weekend"></div>
    
    <h3>Worldwide Gross per Marvel Franchise!</h3>
    <div id="gross_composite_chart"></div>
</div>



    <script>
   /* queue()
       .defer(d3.json, "data/movie_data.json)
       .await(makeGraphs);
  */
    
    var franchiseData = [
{"universe": "Marvel", "title": "Iron Man", "franchise": "Iron Man", "budget": 186e6, "gross": 585e6, "opening": 102e6, "date": "02/05/2008", "cinemas": 4154},

{"universe": "Marvel", "title": "Iron Man II", "franchise": "Iron Man", "budget": 170e6, "gross": 621e6, "opening": 128e6, "date": "07/05/2010", "cinemas": 4390},

{"universe": "Marvel", "title": "Iron Man III", "franchise": "Iron Man", "budget": 200e6, "gross": 1215e6, "opening": 174e6, "date": "03/05/2013", "cinemas": 4253},

{"universe": "Marvel", "title": "Captain America I: The First Avenger", "franchise": "Captain America", "budget": 140e6, "gross": 370e6, "opening": 65e6, "date": "22/07/2011", "cinemas": 3715}, 

{"universe": "Marvel", "title": "Captain America II: The Winter Soldier", "franchise": "Captain America", "budget": 170e6, "gross": 714e6, "opening": 95e6, "date": "04/4/2014", "cinemas": 3938}, 

{"universe": "Marvel", "title": "Captain America III: Civil War", "franchise": "Captain America", "budget": 250e6, "gross": 1140e6, "opening": 176e6, "date": "06/05/2016", "cinemas": 4226}, 

{"universe": "Marvel", "title": "Thor", "franchise": "Thor", "budget": 150e6, "gross": 449e6, "opening": 65e6, "date": "05/06/2011", "cinemas": 3955}, 

{"universe": "Marvel", "title": "Thor II: The Dark World", "franchise": "Thor", "budget": 150e6, "gross": 644e6, "opening": 85e6, "date": "08/11/2013", "cinemas": 3841}, 

{"universe": "Marvel", "title": "Thor III: Ragnarock", "franchise": "Thor", "budget": 180e6, "gross": 846e6, "opening": 122e6, "date": "03/11/2017", "cinemas": 4080}, 

{"universe": "Marvel", "title": "Ant Man", "franchise": "Ant-Man", "budget": 130e6, "gross": 518e6, "opening": 57e6, "date": "17/07/2015", "cinemas": 3856}, 

{"universe": "Marvel", "title": "Ant man II", "franchise": "Ant-Man", "budget": 130e6, "gross": 623e6, "opening": 75e6, "date": "06/07/2018", "cinemas":  4206}, 

{"universe": "Marvel", "title": "The Avengers", "franchise": "Avengers", "budget": 225e6, "gross": 1517e6, "opening": 207e6, "date": "04/05/2012", "cinemas": 4349}, 

{"universe": "Marvel", "title": "Avengers II: Age of Ultron", "franchise": "Avengers", "budget": 330e6, "gross": 1403e6, "opening": 191e6, "date": "01/05/2015", "cinemas": 4276}, 

{"universe": "Marvel", "title": "Avengers III: Infinity War", "franchise": "Avengers", "budget": 300e6, "gross": 2048e6, "opening": 257e6, "date": "27/04/2018", "cinemas": 4474}, 

{"universe": "Marvel", "title": "Avengers IV: Endgame", "franchise": "Avengers", "budget": 356e6, "gross": 2713e6, "opening": 357e6, "date": "26/04/2019", "cinemas": 4662}, 

{"universe": "Marvel", "title": "Guardians of The Galaxy", "franchise": "Guardians of the Galaxy", "budget": 170e6, "gross" : 770e6, "opening": 94e6, "date": "01/08/2014", "cinemas": 4088}, 

{"universe": "Marvel", "title": "Guardians of The Galaxy 2", "franchise": "Guardians of the Galaxy", "budget": 200e6, "gross": 862e6, "opening": 146e6, "date": "05/05/2017", "cinemas": 4347}, 
        ];
    
    var ndx = crossfilter(franchiseData);
    
    /* date formatting */
    var parseDate = d3.time.format("%d/%m/%Y").parse;
    franchiseData.forEach(function (d){
        d.date = parseDate(d.date);
    });
    
    var date_dim = ndx.dimension(dc.pluck('date'));
    
    var min_date = date_dim.bottom(1)[0].date;
    var max_date = date_dim.top(1)[0].date;
    
    /* for budget related scatter graph */
    var budget_dim = ndx.dimension(function (d) {
        return [d.date, d.budget];
    });
    var budget_group = budget_dim.group();
    
    /*scatter graph 2*/
    var gross_progress_dim = ndx.dimension(function (d) {
        return [d.date, d.gross];
    });
    var gross_progress_group = gross_progress_dim.group();
    
    /* for franchise related graphs */
    var franchise_dim = ndx.dimension(dc.pluck('franchise'));
    
    var total_gross_per_franchise = franchise_dim.group().reduceSum(dc.pluck("gross"));
    var cinemas_per_franchise = franchise_dim.group().reduceSum(dc.pluck("cinemas"));
    var budget_per_franchise = franchise_dim.group().reduceSum(dc.pluck("budget"));
    
    /* for title related graphs */
    var title_dim = ndx.dimension(dc.pluck('title'));
    
    var gross_per_title = title_dim.group().reduceSum(dc.pluck("gross"));
    var budget_per_title = title_dim.group().reduceSum(dc.pluck("budget"));
    
    /* opening */
    var weekend_gross = date_dim.group().reduceSum(dc.pluck('opening'));
   
   /*budget stacked graph*/
    
    var infinityWarBudget = franchise_dim.group().reduceSum(function (d) {
             if (d.title === "Avengers III: Infinity War") {
                 return +d.budget;
             } else {
                 return 0;
             }
         });
    
    var endgameBudget = franchise_dim.group().reduceSum(function (d) {
          if (d.title === "Avengers IV: Endgame") {
                 return +d.budget;
             } else {
                 return 0;
             }
         });
    
    // var avengers"gross" = franchise_dim.group().reduceSum(function (d) {
    //     if (d.title === "The Avengers") {
    //         return +d."gross";
    //     } else {
    //         return 0;
    //     }
    // })
    
    // var ultron"gross" = franchise_dim.group().reduceSum(function (d) {
    //     if (d.title === "Avengers II: Age of Ultron") {
    //         return +d."gross";
    //     } else {
    //         return 0;
    //     }
    // })
    
    // var ant_man"gross" = franchise_dim.group().reduceSum(function (d) {
    //     if (d.title === "Ant Man") {
    //         return +d."gross";
    //     } else {
    //         return 0;
    //     }
    // })
        
        dc.barChart("#gross_movie")
            .width(800)
            .height(500)
            .margins({top: 10, right: 50, bottom: 30, left: 100})
            .dimension(franchise_dim)
            .group(total_gross_per_franchise)
            // .stack(infinitywargross, "Infinity War")
            // .stack(infinitywar"gross", "Infinity War")
            // .stack(endgame"gross", "endgame")
            // .stack(avengers"gross", "avengers")
            // .stack(ultron"gross", "Avengers II: Age of Ultron")
            // .stack(ant_man"gross", "ant man")
            .transitionDuration(500)
            .x(d3.scale.ordinal())
            .xUnits(dc.units.ordinal)
            .xAxisLabel("MCU Franchises (2+ movies)")
            .yAxisLabel("Worldwide gross ($)")
            .yAxis().ticks(7);
            
            dc.barChart("#cinemas_per_franchise")
            .width(800)
            .height(500)
            .margins({top: 10, right: 50, bottom: 30, left: 100})
            .dimension(franchise_dim)
            .group(cinemas_per_franchise)
            // .stack(infinitywargross, "Infinity War")
            // .stack(infinitywar"gross", "Infinity War")
            // .stack(endgame"gross", "endgame")
            // .stack(avengers"gross", "avengers")
            // .stack(ultron"gross", "Avengers II: Age of Ultron")
            // .stack(ant_man"gross", "ant man")
            .transitionDuration(500)
            .x(d3.scale.ordinal())
            .xUnits(dc.units.ordinal)
            .xAxisLabel("MCU Franchises (2+ movies)")
            .yAxisLabel("Cinemas Released In)")
            .yAxis().ticks(4);
        
        dc.pieChart("#gross_title")
            .height(300)
            .radius(1500)
            .dimension(title_dim)
            .group(gross_per_title)
            .transitionDuration(1500);
        
        dc.pieChart("#budgetpertitle")
            .height(500)
            .radius(2000)
            .dimension(title_dim)
            .group(budget_per_title)
            .transitionDuration(1500);
        
        var budget_chart = dc.scatterPlot("#scatter");
        budget_chart 
            .width(800)
            .height(500)
            .x(d3.time.scale().domain([min_date, max_date]))
            .brushOn(false)
            .symbolSize(8)
            .clipPadding(10)
            .xAxisLabel("Release Date of MCU Movies")
            .yAxisLabel("Budget Spent")
            .dimension(budget_dim)
            .group(budget_group)
            .margins({top: 10, right: 50, bottom: 75, left: 75});
        
        var gross_chart = dc.scatterPlot("#gross_scatter_chart");
        gross_chart 
            .width(800)
            .height(500)
            .x(d3.time.scale().domain([min_date, max_date]))
            .brushOn(false)
            .symbolSize(8)
            .clipPadding(10)
            .xAxisLabel("Release Date of MCU Movies")
            .yAxisLabel("Worldwide gross (Â£ billions)")
            .dimension(gross_progress_dim)
            .group(gross_progress_group)
            .margins({top: 10, right: 50, bottom: 75, left: 75});
            
        dc.lineChart("#weekend")
            .width(1100)
            .height(300)
            .margins({top: 10, right: 50, bottom: 30, left: 50})
            .dimension(date_dim)
            .group(weekend_gross)
            .transitionDuration(500)
            .x(d3.time.scale().domain([min_date, max_date]))
            .xAxisLabel("Years")
            .yAxisLabel("Releases of MCU Movies")
            .yAxis().ticks(7);
            
            /*composite graph**/
            var ironManFranchiseGross = date_dim.group().reduceSum(function (d){
                if (d.franchise === "Iron Man") {
                    return +d.gross;
                } else {
                    return 0;
                }
            });
            
            
            var captainAmericaFranchiseGross = date_dim.group().reduceSum(function (d){
                if (d.franchise === "Captain America") {
                    return +d.gross;
                } else {
                    return 0;
                }
            });
            
            var avengersFranchiseGross = date_dim.group().reduceSum(function (d){
                if (d.franchise === "Avengers") {
                    return +d.gross;
                } else {
                    return 0;
                }
            });
            
            var thorFranchiseGross = date_dim.group().reduceSum(function (d){
                if (d.franchise === "Thor") {
                    return +d.gross;
                } else {
                    return 0;
                }
            });
            
            var antManFranchiseGross = date_dim.group().reduceSum(function (d){
                if (d.franchise === "Ant-Man") {
                    return +d.gross;
                } else {
                    return 0;
                }
            });
            
            var guardiansFranchiseGross = date_dim.group().reduceSum(function (d){
                if (d.franchise === "Guardians of the Galaxy") {
                    return +d.gross;
                } else {
                    return 0;
                }
            });
            
            var compositeChart = dc.compositeChart('#gross_composite_chart');
            compositeChart
                .width(1000)
                .height(200)
                .dimension(date_dim)
                .x(d3.time.scale().domain([min_date, max_date]))
                .yAxisLabel("gross")
                .legend(dc.legend().x(80).y(20).itemHeight(13).gap(5))
                .renderHorizontalGridLines(true)
                .compose([
                    dc.lineChart(compositeChart)
                        .colors('red')
                        .group(ironManFranchiseGross, "Iron Man"),
                    dc.lineChart(compositeChart)
                        .colors('blue')
                        .group(captainAmericaFranchiseGross, "Captain America"),
                    dc.lineChart(compositeChart)
                        .colors('green')
                        .group(avengersFranchiseGross, "Avengers"),
                    dc.lineChart(compositeChart)
                        .colors('orange')
                        .group(thorFranchiseGross, "thor"),
                    dc.lineChart(compositeChart)
                        .colors('black')
                        .group(antManFranchiseGross, "Ant-Man"),
                    dc.lineChart(compositeChart)
                        .colors('purple')
                        .group(guardiansFranchiseGross, "Guardians of the Galaxy")
                    ])
                    .brushOn(false);
   
    dc.renderAll();
    
    </script>

</body>
</html>